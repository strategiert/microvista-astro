---
/**
 * Branchen Index - Übersicht aller Branchen-Seiten
 */
import BaseLayout from '../../layouts/BaseLayout.astro';
import Header from '../../components/layout/Header.astro';
import Footer from '../../components/layout/Footer.astro';
import Breadcrumbs from '../../components/layout/Breadcrumbs.astro';
import Card from '../../components/ui/Card.astro';
import { getCollection } from 'astro:content';
import { localePath, type Locale } from '../../i18n/translations';

const locale = (Astro.locals.locale || 'de') as Locale;
const lp = (path: string) => localePath(path, locale);

// Branchen-Daten laden
const branchen = await getCollection('branchen');

const content = {
  de: {
    title: 'Branchen',
    subtitle: 'Industrielle CT-Lösungen für Ihre Branche',
    description: 'Jede Branche hat spezifische Anforderungen an die Qualitätsprüfung. Entdecken Sie, wie Microvista CT-Technologie Ihre Herausforderungen löst.',
    cta: 'Mehr erfahren'
  },
  en: {
    title: 'Industries',
    subtitle: 'Industrial CT solutions for your industry',
    description: 'Every industry has specific quality inspection requirements. Discover how Microvista CT technology solves your challenges.',
    cta: 'Learn more'
  },
  fr: {
    title: 'Secteurs',
    subtitle: 'Solutions CT industrielles pour votre secteur',
    description: 'Chaque secteur a ses propres exigences qualité. Découvrez comment la technologie CT de Microvista répond à vos défis.',
    cta: 'En savoir plus'
  },
  es: {
    title: 'Sectores',
    subtitle: 'Soluciones CT industriales para su sector',
    description: 'Cada sector tiene requisitos específicos de calidad. Descubra cómo la tecnología CT de Microvista resuelve sus desafíos.',
    cta: 'Más información'
  },
  it: {
    title: 'Settori',
    subtitle: 'Soluzioni CT industriali per il tuo settore',
    description: 'Ogni settore ha requisiti specifici di qualità. Scopri come la tecnologia CT di Microvista risolve le tue sfide.',
    cta: 'Scopri di più'
  }
};

const t = content[locale as keyof typeof content] || content.en || content.de;

const ctaContent = {
  de: {
    title: 'Ihre Branche nicht dabei?',
    text: 'CT-Technologie ist vielseitig einsetzbar. Kontaktieren Sie uns für eine individuelle Beratung zu Ihren spezifischen Anforderungen.',
    button: 'Beratung anfragen'
  },
  en: {
    title: 'Your industry not listed?',
    text: 'CT technology is versatile. Contact us for individual consultation on your specific requirements.',
    button: 'Request consultation'
  },
  fr: {
    title: 'Votre secteur n’est pas listé ?',
    text: 'La technologie CT est polyvalente. Contactez-nous pour un conseil adapté à vos exigences spécifiques.',
    button: 'Demander une consultation'
  },
  es: {
    title: '¿Su sector no aparece?',
    text: 'La tecnología CT es versátil. Contáctenos para una consulta adaptada a sus necesidades específicas.',
    button: 'Solicitar consulta'
  },
  it: {
    title: 'Il tuo settore non è presente?',
    text: 'La tecnologia CT è versatile. Contattaci per una consulenza personalizzata sulle tue esigenze specifiche.',
    button: 'Richiedi consulenza'
  }
}[locale] || {
  title: 'Your industry not listed?',
  text: 'CT technology is versatile. Contact us for individual consultation on your specific requirements.',
  button: 'Request consultation'
};

// Fallback-Branchen falls Collection leer
const defaultBranchen = [
  {
    slug: 'automotive',
    data: {
      name: 'Automotive',
      description: 'Qualitätssicherung für Gussteile, Schweißverbindungen und Elektronik-Komponenten in der Automobilindustrie.',
      heroImage: '/images/branchen/automotive.jpg'
    }
  },
  {
    slug: 'elektronik',
    data: {
      name: 'Elektronik',
      description: 'Inspektion von Leiterplatten, BGAs, Lötstellen und Mikroelektronik mit höchster Auflösung.',
      heroImage: '/images/branchen/elektronik.jpg'
    }
  },
  {
    slug: 'medizintechnik',
    data: {
      name: 'Medizintechnik',
      description: 'FDA-konforme Prüfung von Implantaten, Instrumenten und sterilen Verpackungen.',
      heroImage: '/images/branchen/medizintechnik.jpg'
    }
  },
  {
    slug: 'luftfahrt',
    data: {
      name: 'Luft- und Raumfahrt',
      description: 'Zertifizierte Prüfung sicherheitskritischer Komponenten nach Luftfahrt-Standards.',
      heroImage: '/images/branchen/luftfahrt.jpg'
    }
  },
  {
    slug: 'kunststoff',
    data: {
      name: 'Kunststoffverarbeitung',
      description: 'Analyse von Spritzgussteilen, Hohlräumen, Wandstärken und Faserverstärkungen.',
      heroImage: '/images/branchen/kunststoff.jpg'
    }
  },
  {
    slug: 'energie',
    data: {
      name: 'Energie',
      description: 'Prüfung von Batteriezellen, Brennstoffzellen und Komponenten für erneuerbare Energien.',
      heroImage: '/images/branchen/energie.jpg'
    }
  }
];

const displayBranchen = branchen.length > 0 ? branchen : defaultBranchen;
---

<BaseLayout
  title={t.title}
  description={t.subtitle}
>
  <Header slot="header" />

  <div class="container">
    <Breadcrumbs items={[
      { label: t.title }
    ]} />

    <!-- Hero -->
    <section class="page-hero">
      <h1>{t.title}</h1>
      <p class="subtitle">{t.subtitle}</p>
      <p class="description">{t.description}</p>
    </section>

    <!-- Branchen Grid -->
    <section class="branchen-grid">
      {displayBranchen.map((branche, index) => (
        <Card
          href={lp(`/branchen/${branche.slug}`)}
          variant={index === 0 ? 'featured' : 'default'}
          class={index === 0 ? 'branche-featured' : ''}
        >
          <div slot="image" class="branche-image">
            <div class="image-placeholder">
              <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M2 20a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8l-7 5V8l-7 5V4a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"/>
              </svg>
            </div>
          </div>
          <h3 slot="title">{branche.data.name}</h3>
          <p slot="description">{branche.data.description}</p>
          <div slot="footer" class="card-cta">
            <span>{t.cta}</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M5 12h14M12 5l7 7-7 7"/>
            </svg>
          </div>
        </Card>
      ))}
    </section>

    <!-- CTA Section -->
    <section class="cta-section">
      <div class="cta-content">
        <h2>{ctaContent.title}</h2>
        <p>{ctaContent.text}</p>
        <a href={lp('/kontakt')} class="btn btn-primary btn-lg">
          {ctaContent.button}
        </a>
      </div>
    </section>
  </div>

  <Footer slot="footer" />
</BaseLayout>

<style>
  .page-hero {
    text-align: center;
    padding: var(--space-12) 0;
    max-width: 800px;
    margin: 0 auto;
  }

  .page-hero h1 {
    font-size: var(--text-5xl);
    margin-bottom: var(--space-4);
  }

  .subtitle {
    font-size: var(--text-2xl);
    color: var(--primary);
    margin-bottom: var(--space-4);
  }

  .description {
    font-size: var(--text-lg);
    color: var(--text-muted);
  }

  .branchen-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: var(--space-6);
    margin: var(--space-12) 0;
  }

  @media (min-width: 768px) {
    .branche-featured {
      grid-column: span 2;
    }

    .branche-featured .branche-image {
      aspect-ratio: 21/9;
    }
  }

  .branche-image {
    aspect-ratio: 16/9;
    background: linear-gradient(135deg, var(--surface) 0%, rgba(124, 58, 237, 0.1) 100%);
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .image-placeholder {
    color: var(--primary);
    opacity: 0.5;
  }

  .card-cta {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    color: var(--primary);
    font-weight: 600;
  }

  .card-cta svg {
    transition: transform var(--transition-fast);
  }

  :global(.card:hover) .card-cta svg {
    transform: translateX(4px);
  }

  .cta-section {
    background: var(--surface);
    border-radius: var(--radius-2xl);
    padding: var(--space-16);
    margin: var(--space-16) 0;
    text-align: center;
  }

  .cta-content {
    max-width: 600px;
    margin: 0 auto;
  }

  .cta-content h2 {
    margin-bottom: var(--space-4);
  }

  .cta-content p {
    color: var(--text-muted);
    margin-bottom: var(--space-8);
  }
</style>
